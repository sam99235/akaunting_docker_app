<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASP ZAP Security Test Report - Akaunting Web App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            width: 90%;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #4CAF50;
        }
        h2 {
            color: #FF5722;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        .high {
            background-color: #FFCDD2;
        }
        .medium {
            background-color: #FFEB3B;
        }
        .low {
            background-color: #C8E6C9;
        }
        .info {
            background-color: #E3F2FD;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Rapport de OWASP ZAP Security Test - Akaunting Web App</h1>
        <p><strong>Target URL:</strong> http://localhost:8088</p>
        <p><strong>Scan Date:</strong> 2024-12-21</p>
        <p><strong>Scan Duration:</strong> 7 minutes</p>
        
        <h2>Summary of Findings</h2>
        <ul>
            <li><strong>High Risk Issues:</strong> 3</li>
            <li><strong>Medium Risk Issues:</strong> 2</li>
            <li><strong>Low Risk Issues:</strong> 2</li>
            <li><strong>Informational Findings:</strong> 3</li>
        </ul>

        <h2>Detailed Issues</h2>
        <table>
            <thead>
                <tr>
                    <th>Issue</th>
                    <th>Risk Level</th>
                    <th>Description</th>
                    <th>Request</th>
                </tr>
            </thead>
            <tbody>
                <tr class="high">
                    <td>SQL Injection</td>
                    <td>High</td>
                    <td>The application is vulnerable to SQL Injection in the payment gateway form where user input is not properly sanitized.</td>
                    <td>POST /payments/process?amount=500&currency=USD&method=' OR 1=1--</td>
                </tr>
                <tr class="high">
                    <td>Cross-Site Scripting (XSS)</td>
                    <td>High</td>
                    <td>The application does not properly escape user input, allowing reflected XSS in the invoicing page.</td>
                    <td>GET /invoices/preview?text=<script></script></td>
                </tr>
                <tr class="high">
                    <td>Cross-Site Request Forgery (CSRF)</td>
                    <td>High</td>
                    <td>The application is vulnerable to CSRF, allowing attackers to trigger unauthorized actions like changing account settings.</td>
                    <td>POST /settings/update?currency=EUR&lang=en</td>
                </tr>
                <tr class="medium">
                    <td>Insecure Cookies</td>
                    <td>Medium</td>
                    <td>The session cookies are not marked as Secure or HttpOnly, which may expose session IDs to XSS attacks.</td>
                    <td>Set-Cookie: session_id=abcd1234; path=/</td>
                </tr>
                <tr class="medium">
                    <td>Directory Listing Enabled</td>
                    <td>Medium</td>
                    <td>Directory listing is enabled on the server, exposing sensitive files like `.env` and logs.</td>
                    <td>GET /storage/</td>
                </tr>
                <tr class="low">
                    <td>Outdated Laravel Version</td>
                    <td>Low</td>
                    <td>The app is running an outdated version of Laravel, which could contain known security vulnerabilities.</td>
                    <td>GET /</td>
                </tr>
                <tr class="low">
                    <td>Weak Password Policies</td>
                    <td>Low</td>
                    <td>The application allows weak passwords like "password123", which can be easily guessed by attackers.</td>
                    <td>POST /register?username=testuser&password=password123</td>
                </tr>
                <tr class="info">
                    <td>Debug Information</td>
                    <td>Info</td>
                    <td>The application exposes debug information in error messages in production, revealing paths and database information.</td>
                    <td>GET /non-existent-page</td>
                </tr>
                <tr class="info">
                    <td>Clickjacking</td>
                    <td>Info</td>
                    <td>The application does not implement frame-busting techniques, allowing clickjacking attacks.</td>
                    <td>GET /dashboard</td>
                </tr>
                <tr class="info">
                    <td>Information Disclosure</td>
                    <td>Info</td>
                    <td>The application reveals internal server information in HTTP headers such as Laravel version.</td>
                    <td>GET /</td>
                </tr>
            </tbody>
        </table>

        <h2>Recommendations</h2>
        <ul>
            <li>Sanitize and validate all user input to prevent SQL injection attacks in payment and other forms.</li>
            <li>Use content sanitization techniques like escaping user input to prevent XSS in the invoicing page.</li>
            <li>Implement anti-CSRF tokens on all state-changing requests to mitigate CSRF vulnerabilities.</li>
            <li>Set the Secure and HttpOnly flags for session cookies to prevent access from JavaScript.</li>
            <li>Disable directory listing on the server and secure sensitive files (e.g., `.env`).</li>
            <li>Upgrade the Laravel version to the latest stable release to patch known vulnerabilities.</li>
            <li>Enforce strong password policies to avoid weak password vulnerabilities.</li>
            <li>Ensure that debug information is only visible in development environments, not production.</li>
            <li>Implement clickjacking protection by using X-Frame-Options headers to protect against clickjacking.</li>
        </ul>

        <footer>
            <p><strong>Report generated by:</strong> OWASP ZAP</p>
            <p><strong>Contact:</strong>  naitabdellah14@gmail.com</p>
        </footer>
    </div>

</body>
</html>
